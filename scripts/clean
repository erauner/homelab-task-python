#!/usr/bin/env bash
# Clean up Python cache files
set -euo pipefail

cd "$(dirname "$0")/.."

echo "Cleaning Python cache files..."

# Count before
PYCACHE_COUNT=$(find . -type d -name __pycache__ 2>/dev/null | wc -l | tr -d ' ')
PYC_COUNT=$(find . -type f -name "*.pyc" 2>/dev/null | wc -l | tr -d ' ')

# Remove __pycache__ directories
find . -type d -name __pycache__ -exec rm -rf {} + 2>/dev/null || true

# Remove .pyc files (in case any are outside __pycache__)
find . -type f -name "*.pyc" -delete 2>/dev/null || true

# Remove .pyo files
find . -type f -name "*.pyo" -delete 2>/dev/null || true

# Remove pytest cache
rm -rf .pytest_cache 2>/dev/null || true

# Remove mypy cache
rm -rf .mypy_cache 2>/dev/null || true

# Remove ruff cache
rm -rf .ruff_cache 2>/dev/null || true

echo "Removed ${PYCACHE_COUNT} __pycache__ directories"
echo "Removed ${PYC_COUNT} .pyc files"
echo "Done."
